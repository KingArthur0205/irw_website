---
title: "Data documentation"
---

Click on each dataset's name to see its description, license, citation, and link to its original source. Code used to create these data can be found [here](https://github.com/ben-domingue/irw/tree/main/data).
```{r}
library(purrr)
```

```{=html}
<div class="panel-tabset-container">
  <button onclick="toggleTabset()">R</button>
  <div class="panel-tabset">
    <div class="r-command">
      <p>&gt; <code>irw_citation('gilbert_meta_48')</code></p>
    </div>
    <div class="bibtex-entry">
      <pre>
Citation for 'gilbert_meta_48':
https://doi.org/10.7910/DVN/3SF36J

BibTeX entry for 'gilbert_meta_48':
@misc{https://doi.org/10.7910/dvn/3sf36j,
  doi = {10.7910/DVN/3SF36J},
  url = {https://dataverse.harvard.edu/citation?persistentId=doi:10.7910/DVN/3SF36J},
  author = {CÃ¡rdenas, Sergio and Evans, David K.},
  keywords = {Social Sciences},
  title = {Replication Data for: Parent Training and Child Development at Low Cost? Evidence from a Randomized Field Experiment in Mexico},
  publisher = {Harvard Dataverse},
  year = {2023}
}
      </pre>
    </div>
  </div>
</div>

<style>
/* Style for the toggle button */
.panel-tabset-container button {
  margin-bottom: 10px;
  padding: 5px 10px;
  background-color: #007BFF;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.panel-tabset-container button:hover {
  background-color: #0056b3;
}

/* Style for the panel content */
.panel-tabset {
  border: 1px solid #ddd;
  padding: 10px;
  border-radius: 4px;
  background: #f9f9f9;
  font-family: 'Courier New', Courier, monospace;
}

/* Style for the R command line */
.r-command {
  margin-bottom: 15px;
  color: #333;
  font-size: 14px;
}

.r-command p {
  margin: 0;
  padding: 5px;
  background-color: #f3f3f3;
  border-left: 3px solid #007BFF;
  font-family: monospace;
}

/* Style for the BibTeX block */
.bibtex-entry pre {
  background-color: #f3f3f3;
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #ccc;
  font-family: monospace;
  font-size: 14px;
  overflow-x: auto;
}
</style>

<script>
  function toggleTabset() {
    const tabset = document.querySelector('.panel-tabset');
    if (tabset.style.display === 'none') {
      tabset.style.display = 'block';
    } else {
      tabset.style.display = 'none';
    }
  }
</script>

```

```{r}
#| results: asis

library(dplyr)
library(purrr)
library(readr)
library(stringr)
library(glue)

# Load datasets
data_index <- read_csv("data/IRW Data Dictionary - data index.csv",
                       na = character()) |>
  select(dataset = `Filename`, url = URL, license = `Derived License`,
         description = Description, reference = Reference, doi = DOI) |>
  mutate(dataset = str_remove(dataset, ".R.ata$"))

dataset_without_doi <- read_csv("data/BibTex_Manual.csv", na=character())

# Populate missing DOI with BibTex from dataset_without_doi
data_index <- data_index %>% 
  left_join(dataset_without_doi, by = c("dataset" = "Filename")) %>% 
  mutate(doi = if_else(is.na(doi) | doi == "", BibTex, doi)) %>% 
  select(-BibTex)


el <- function(ds) {
  lic <- if (ds$license != "") glue("({ds$license})") else ""
  doi <- ds$doi
  escaped_doi <- if (!is.na(doi) && doi != "") gsub("'", "\\\\'", doi) else ""

  doi_button <- if (escaped_doi != "") {
    button_id <- paste0("cite-button-", make.names(ds$dataset))
    target_id <- paste0("cite-text-", make.names(ds$dataset))
    glue(
      '<button id="{button_id}" class="citation-button" onclick="getCitation(`{escaped_doi}`, \'{button_id}\', \'{target_id}\')">
        Get BibTex
      </button>
      <div id="{target_id}" class="citation-text"></div>'
    )
  } else ""

  glue(
    "
    ::: {{.g-col-4 .dataset-item}}
    ::: {{.callout-note collapse='true'}}
    ## {ds$dataset}
    {ds$description} {lic} [[link]]({ds$url})
    <i>{ds$reference}</i>
    {doi_button}
    :::
    :::
    "
  )
}

els <- transpose(data_index) |> map(el) |> paste(collapse = "\n")
cat(glue(
  "
  ::: {{.grid}}
  {els}
  :::
  "
))
```